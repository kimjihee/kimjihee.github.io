<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <style>
               body {
            position: absolute;
            top: 2rem;
            width: 4rem;
        }
        .iamSvg {position:absolute;
        top:2rem;
        left:3rem;}
        
        p { color: black;
            padding-left: 1rem;
            font-size:0.8rem;
            margin:0;
            padding:12;
        }
        
    </style>
    <script src="d3.min.js" type="text/javascript"></script>
</head>

<body>
    <svg height="2000" width="700" class="iamSvg">
    </svg>

    <p> </p>

    <script>
        var dataSet = [];

        // labour data

                var labourMale = d3.csv('data/Child_labour.csv', function (err, labour) {
                    labour.forEach(function (row) {
                        row['Value'] = +row['Value'] * 0.03;
                    });
                    labour = labour.filter(function (row) {
                        return row['Subgroup'].startsWith('Male');
                    });
                    dataSet = labour;
                    redraw();
                });


        // attend data

        var attendMale = d3.csv('data/attendance_in_primary_education.csv', function (a, attend) {
            attend.forEach(function (row) {
                row['Value'] = +row['Value'] * 0.03;
            });
            attend = attend.filter(function (row) {
                return row['Subgroup'].startsWith('Male');
            });
            dataSet = attend;
            redraw2();

        });



        // country
        //
        var country = d3.csv('data/Child_labour.csv', function (b, attend2) {
                        attend2 = attend2.filter(function (row) {
                return row['Country'];
            });
            dataSet = attend2;
            write();

        });


                function redraw() {
                    var rects = d3.select('svg').selectAll('rect').data(dataSet);
        
                    rects.enter()
                        .append('rect')
                        .attr('x', 40)
                        .attr('width', 0)
                        .attr('height', 15)
                        .attr('fill', 'skyblue')
                    .attr('fill-opacity','0.3');
        
                    // Exit
                    rects.exit()
                        .remove();
        
                    // Update
                    rects.attr('y', function (_, i) {
                            return 10 + i *18;
                        })
                        .transition()
                        .attr('width', function (d) {
                            return d['Value'] *30;
                        });
        
                }

        
//                function redraw2() {
//                    var rects = d3.select('svg').selectAll('rect').data(dataSet);
//        
//                    rects.enter()
//                        .append('rect')
//                        .attr('x', 240)
//                        .attr('width', 0)
//                        .attr('height', 18)
//                        .attr('fill', 'grey')
//                    .attr('fill-opacity','0.3');
//        
//                    // Exit
//                    rects.exit()
//                        .remove();
//        
//                    // Update
//                    rects.attr('y', function (_, i) {
//                            return 10 + i * 15;
//                        })
//                        .transition()
//                        .attr('width', function (d) {
//                        return d['Value']*30;
//                        });
//        
//                }
        
        function write() {
            var countryName = d3.select('body').selectAll('p').data(dataSet);
            countryName.enter()
                .append('p').text(function(d){return d;});
        }
        

        
        
    </script>
</body>

</html>