<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>workingTime</title>
    <style>
        @import url(http://fonts.googleapis.com/earlyaccess/nanumgothiccoding.css);
        body {
            font-family: 'Roboto', sans-serif;
            font-size: 0.4rem;
        }
        
        .axis path,
        .axis line {
            fill: none;
            stroke: #000;
            shape-rendering: crispEdges;
        }
    </style>
    <link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro' rel='stylesheet' type='text/css'>
    <script src="d3.min.js" type="text/javascript"></script>
</head>

<body>
    <svg id="chart"> </svg>
    <script>
         
//--------------------------------------Data---------------------------------------------
        var yearExtent = [1980,1981,1982,1983,1984,1985,1986,1987,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2005,2006,2007];
//             yearExtent = for(var i=1980; i<2008; i++){i}
        var dataSet = [];
        var Workingtime = d3.csv('data/working_hours_per_week.csv', function (err, time) {
            time.forEach(function (row){
                row['Country'] = row['Country'];
                                 for(var i=1980; i<2008; i++){
                          row['i'] = +row['i']; 
                         
                          }
                      });
            
           
            
            var Nest = d3.nest()
            .key(function(d){
                return d.Country;
            })
            .entries(time);
            
            dataSet = Nest; 
            
            redraw();
       });
       
      
                    
             var redraw = function () {   
//------------------------------------------Draw------------------------------------------
                                 
                    var MARGIN = {
                        START:0
                        , TOP: 50
                        , LEFT: 100
                        , RIGHT: 100
                        , BOTTOM: 0
                    , }
         
                    var Width = 1000;
                    var Height =500;

//------------------------------------------One Graph-------------------------------------                         console.log(yearExtent);
                    var countryNames = dataSet.map(function(d) {return d['key'];});
                    var xScale = d3.scale.linear()
                        .domain([1980,2007])// 여기는 데이터 전체가 아니라 시작부터 끝.
                        .rangeRound([0, Width]);//라운드랑 밴드랑 먼지모름.
                 
                    var yScale = d3.scale.ordinal()
                        .domain(countryNames)
                        .rangeRoundBands([0,Height - MARGIN.TOP - MARGIN.BOTTOM], 0.01);
        
                    var xAxis = d3.svg.axis()
                        .scale(xScale)
                        .orient('bottom')
                        .tickSize(3)
                        .tickFormat(function (d) {
                         return d;
                         });
                        
                 
                    var yAxis = d3.svg.axis()
                        .scale(yScale)
                        .orient('left')
                        .tickFormat(function(d) {return d;})
                        .tickSize(3);
                     
                    var svg = d3.select("svg")
                        .attr("width",Width+200)
                        .attr("height", Height+200);

                    var realChart = svg
                        .append('g')
                        .attr("transform", "translate( "+130+" ," + 20 + ")");

                    realChart.append('g')
                        .attr('class', 'x axis')
                        .attr("transform", "translate( 0 ," + Height + ")")
                        .style('stroke-width','3')
                        .call(xAxis);

                    realChart.append('g')
                      .attr('class', 'y axis')
                      .call(yAxis);
            
             
             };
                 
    </script>
    </body>
</html>
