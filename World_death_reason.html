<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>World Death Reason</title>
    <link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro' rel='stylesheet' type='text/css'>
    <script src="d3.min.js" type="text/javascript"></script>
    <style>
        #chart {border:1px solid black;}
    </style>
</head>

<body>
    <svg id="chart" width="1200" height="500"></svg>

<script>
    dataSet =[];
    d3.csv("data/World_Death.csv", function (err, death) {
        death.forEach(function(row) {
            row['전체'] = +row['전체'];
            row['폐암'] = +row['폐암'];
            row['당뇨병'] = +row['당뇨병'];
            row['암'] = +row['암'];
            row['뇌혈관질환'] = +row['뇌혈관질환'];
            row['만성간질환'] = +row['만성간질환'];
            row['운수사고'] = +row['운수사고'];
            row['자살'] = +row['자살'];
                        
        })
        dataSet = death;
        redraw();
    })
    
  
    
    
   var redraw = function(){
       
//--- Layout-----------------------------------------
       
       MARGIN = {
           LEFT : 100,
           RIGHT : 0,
           TOP: 100,
           BOTTOM :0,
                  }
       
       
//--- Size-----------------------------------------------
       
      var Width = document.querySelector('#chart').clientWidth;
      var Height = document.querySelector('#chart').clientHeight;
       
//--- Scale------------------------------------------------
       
       var xScale = d3.scale.ordinal()
       .domain([d3.range(dataSet.length)])
       .rangeRound([0,Width]);
       
       var yScale = d3.scale.ordinal()
       .domain([d3.max(function(d){return dataSet.전체;}),0])
       .rangeRound([0,Height-MARGIN.TOP-MARGIN.BOTTOM]);
       
//--- Axis--------------------------------------------------

        xAxis = d3.svg.axis()
               .scale(xScale)
               .orient(bottom)
               .tickPadding(8);
       
        yAxis = d3.svg.axis()
               .scale(yScale)
               .orient(left)
               .tickPadding(8);
       
//---Call Axis----------------------------------------------
       
        var realChart = d3.select('svg')
                .append('g')
                .attr('transform', 'translate(' + MARGIN.LEFT + ', ' + MARGIN.TOP + ')');
       
       realChart.append('g')
                .attr('class', 'x axis')
                .attr('transform', 'translate(0, ' + (Height - MARGIN.TOP - MARGIN.BOTTOM) + ')')
                .style('stroke-width','3')
                .call(xAxis);      
            
            
       realChart.append('g')
              .attr('class', 'y axis')
              .call(yAxis)
              .append("text")
              .attr("transform", "rotate(-90)")
              .attr("y", 6)
              .attr("dy", "1em")// 이것은 무엇인가?
              .style("text-anchor", "end")
              .text("death Count");
       
       
// http://bl.ocks.org/mbostock/1134768 참고사이트
   };//redraw 닫기;
    
    
</script>
</body>
</html>