<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Seoul Weather</title>
    <style>
        @import url(http://fonts.googleapis.com/earlyaccess/nanumgothiccoding.css);
        body {
            font-family: 'Roboto', sans-serif;
            font-size:0.5rem;
        }
        #chart{ border :1px solid black;}
        
        .axis path, .axis line {
        fill: none;
        stroke: #000;
        shape-rendering: crispEdges;
      }
        
      </style>
    <link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro' rel='stylesheet' type='text/css'>
    
    <script src="d3.min.js" type="text/javascript"></script></head>
    <body>
        <svg id="chart" > </svg>
        
        
        
        <script>

//--- Data---------------------------------------------
        var dateFormat = d3.time.format('%Y');
        var dataSet = [];
//            tonsPerCapita;
        var Emission = d3.csv('data/CO2emissions.csv', function (err, CO2) {
            CO2.forEach(function (row) {
                row['Country'] = row['Country'];
                row['Value'] = +row['Value'];            
               
            });   
            
            var oneYear = CO2.filter(function (row) {
                    return row['Year'].startsWith('2011');
                });  

            
            var Mapping = {};
                 oneYear.forEach(function (row, i) {
                     
                    var key = row["Country"]
                    Mapping[key] = row;
                    Mapping[key] = oneYear[i].Country;
                    
                });
            
             var MappingData = [];
             for (var key in Mapping) {
                    MappingData.push(Mapping[key]);
                }
            
                      
            var Data = MappingData.map(function (c) {
                return CO2.map(function (d) {
                    return {
                        x: d.Value,
                        y: d.Year,
                       
                    };
 
                });
            });
            
               
            dataSet = Data;
            redraw();           
           
            
            
            
//            이렇게 하면 돼 안될까?
//            var countryName = function(d,i){return oneYear[i].Country;};
//            
          
            
       });
         console.log(dataSet);        

      
       
    
        </script>
</body>
</html>